<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>MAHAndroidUpdater by hummatli</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">MAHAndroidUpdater</h1>
      <h2 class="project-tagline">Android update checker library</h2>
      <a href="https://github.com/hummatli/MAHAndroidUpdater" class="btn">View on GitHub</a>
      <a href="https://github.com/hummatli/MAHAndroidUpdater/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/hummatli/MAHAndroidUpdater/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="mahandroidupdater---mobapphome--android-update-helper-library" class="anchor" href="#mahandroidupdater---mobapphome--android-update-helper-library" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>MAHAndroidUpdater - <a href="https://play.google.com/store/apps/developer?id=MobAppHome">MobAppHome</a>  android update helper library</h1>

<p><a href="https://bintray.com/hummatli/maven/mah-android-updater/_latestVersion"> <img src="https://api.bintray.com/packages/hummatli/maven/mah-android-updater/images/download.svg" alt="Download"> </a></p>

<p>MAHAndroidUpdater is library for notifing update information to installed android apps on android device. By it's help old application gets notified about update information from Google Play Market
Library has build on IDE <code>Android Studio</code> and binaries have added to <code>jcenter()</code>  <code>maven</code> repository.
<br>You can check  <a href="https://bintray.com/hummatli/maven/mah-android-updater#statistics">jCenter() download statistics</a> on this link - <a href="https://bintray.com/hummatli/maven/mah-android-updater#statistics">https://bintray.com/hummatli/maven/mah-android-updater#statistics</a></p>

<h1>
<a id="playstore" class="anchor" href="#playstore" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>PlayStore</h1>

<p><a href="https://play.google.com/store/apps/details?id=com.mobapphome.mahandroidupdater.sample">MAHAndroidUpdater - Sample</a> app has published on Google PlayStore. You can easly test module functionality with downloading it.
<br><a href="https://play.google.com/store/apps/details?id=com.mobapphome.mahandroidupdater.sample"><img src="https://raw.githubusercontent.com/hummatli/MAHAndroidUpdater/master/imgs/google-play-badge.png" width="200px"></a> </p>

<h1>
<a id="images" class="anchor" href="#images" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Images</h1>

<p><img src="https://raw.githubusercontent.com/hummatli/MAHAndroidUpdater/master/imgs/updater_dlg.png" width="200px">
<img src="https://raw.githubusercontent.com/hummatli/MAHAndroidUpdater/master/imgs/restricter_dlg.png" width="200px"></p>

<h1>
<a id="service-structure" class="anchor" href="#service-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Service structure</h1>

<p>To provide update information to your app you need to implement service responding json data about application current state. Structure of the json data is as below.</p>

<p>Json with sample data </p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>is_run_mode<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>MAHUpdater Sample<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>uri_current<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>com.mobapphome.mahandroidupdater.sample<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>version_code_current<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>version_code_min<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>update_info<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>On version 1.0 we added bla bla<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>update_date<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>16/07/2016<span class="pl-pds">"</span></span>
}</pre></div>

<ul>
<li>
<code>is_run_mode</code> - service mode: if it's false modul will not react to service and will not show dialogs</li>
<li>
<code>name</code> - name of the belonging app</li>
<li>
<code>uri_current</code> - current package path</li>
<li>
<code>version_code_current</code> - current version code avilable</li>
<li>
<code>version_code_min</code> - Minimum version code, which does not work normal and had to force to update</li>
<li>
<code>update_info</code> - Update information</li>
<li>
<code>update_date</code> - Update date</li>
</ul>

<p>If one of the variables would not be on json, then modul will not repond to service and act, Try to implement all data.</p>

<h1>
<a id="library-structure" class="anchor" href="#library-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Library structure</h1>

<p>Library contains from to Dialog component</p>

<ul>
<li>
<code>MAHUpdaterDlg</code>- In this situation dialog show to user to update or install newer version and lets to postpone the action to later time and use application</li>
<li>
<code>MAHRestricterDlg</code> - In this situation dialog urges user to update or install newer version and dont alow use older version</li>
</ul>

<p>The porpose of lib to show automatically these dialogs on application start if there are any need for it.
<b>-</b> <code>MAHUpdaterDlg</code> opens on following situation.</p>

<ul>
<li>Or <code>uri_current</code> value is different from app's installed package url</li>
<li>Or <code>version_code_current</code> value is greater than app's installed version on device</li>
</ul>

<p><b>-</b> <code>MAHRestricterDlg</code> opens on all situation <code>MAHUpdaterDlg</code> opens and following situation.</p>

<ul>
<li>
<code>version_code_min</code> value is greater than app's installed version on device</li>
</ul>

<p>But when you develop your apps UI and want to show these dialogs there are test modes also and you can open dialogs by calling methods relatively </p>

<ul>
<li>
<code>MAHUpdaterController.testUpdaterDlg(activity);</code> - <code>MAHUpdaterDlg</code> </li>
<li>
<code>MAHUpdaterController.testRestricterDlg(activity);</code> - <code>MAHRestricterDlg</code> </li>
</ul>

<h1>
<a id="installation-manual" class="anchor" href="#installation-manual" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation manual</h1>

<p><b><code>1)</code></b> To import library to you project add following lines to project's <code>build.gradle</code> file. The last stable version is <code>1.0.12</code></p>

<pre><code>    dependencies {
            compile 'com.mobapphome.library:mah-android-updater:1.0.14'
    }
</code></pre>

<p><b><code>2)</code></b> On the start of your application call <code>MAHUpdaterController.init()</code> method to initialize modul. For example: MainActivity's <code>onCreate()</code> method or in splash activity. Check http url is correct and points to your service on the web.
Code: </p>

<div class="highlight highlight-source-java"><pre>    <span class="pl-smi">MAHUpdaterController</span><span class="pl-k">.</span>init(activity,<span class="pl-s"><span class="pl-pds">"</span>http://highsoft.az/mah-android-updater-sample.php<span class="pl-pds">"</span></span>);</pre></div>

<p><b><code>3)</code></b> When you quit app, you have to call <code>MAHUpdaterController.end()</code> method to finalize modul.  For example: MainActivity's <code>onDestroy()</code> method. </p>

<div class="highlight highlight-source-java"><pre>    <span class="pl-smi">MAHUpdaterController</span><span class="pl-k">.</span>end();                     </pre></div>

<p><b><code>4)</code></b> To customize <code>MAHAndroidUpdater</code> dialog UI and overide colors set these values on your main projects <code>color.xml</code> file</p>

<div class="highlight highlight-text-xml"><pre>    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_window_background_color<span class="pl-pds">"</span></span>&gt;#FFFFFFFF&lt;/<span class="pl-ent">color</span>&gt;
    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_title_bar_color<span class="pl-pds">"</span></span>&gt;#FF3F51B5&lt;/<span class="pl-ent">color</span>&gt;
    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_info_txt_color<span class="pl-pds">"</span></span>&gt;#FF3F51B5&lt;/<span class="pl-ent">color</span>&gt;

    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_restricter_dlg_btn_pressed_color<span class="pl-pds">"</span></span>&gt;#a33F51B5&lt;/<span class="pl-ent">color</span>&gt;
    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_restricter_dlg_btn_dark_state_color<span class="pl-pds">"</span></span>&gt;#ff3F51B5&lt;/<span class="pl-ent">color</span>&gt;
    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_restricter_dlg_btn_light_state_color<span class="pl-pds">"</span></span>&gt;#ffffffff&lt;/<span class="pl-ent">color</span>&gt;

    &lt;<span class="pl-ent">color</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_upd_dlg_btn_text_color<span class="pl-pds">"</span></span>&gt;#ffFF4081&lt;/<span class="pl-ent">color</span>&gt;          </pre></div>

<p><b><code>5)</code></b><code>Localization:</code>  Module now supports 4 languages <code>(English, Azerbaijan, Russia, Turkey)</code> .  To set localization to app use your own method or if it is static and don't change in program session you can just simply add      <code>LocaleUpdater.updateLocale(this, "your_lang");</code> in the start of your app. For examlpe  <code>LocaleUpdater.updateLocale(this, "ru");</code></p>

<p><b><code>6)</code></b> To customize <code>MAHAndroidUpdater</code> UI texts and overide them add these lines to main projects <code>string.xml</code> and set them values</p>

<div class="highlight highlight-text-xml"><pre>    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_title<span class="pl-pds">"</span></span>&gt;Update info&lt;/<span class="pl-ent">string</span>&gt;
    <span class="pl-c">&lt;!-- Button texts--&gt;</span>
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_btn_no_later_txt<span class="pl-pds">"</span></span>&gt;Later&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_btn_no_close_txt<span class="pl-pds">"</span></span>&gt;Close&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_btn_yes_update_txt<span class="pl-pds">"</span></span>&gt;Update&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_btn_yes_install_txt<span class="pl-pds">"</span></span>&gt;Install&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_btn_yes_open_new_txt<span class="pl-pds">"</span></span>&gt;Open new version&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_dlg_btn_no_uninstall_old_txt<span class="pl-pds">"</span></span>&gt;Uninstall old&lt;/<span class="pl-ent">string</span>&gt;

    <span class="pl-c">&lt;!-- Info texts--&gt;</span>
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_updater_info_install<span class="pl-pds">"</span></span>&gt;Application has moved to new address. Please install newer version&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_updater_info_update<span class="pl-pds">"</span></span>&gt;"New version is available. Please update application"&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_restricter_info_install<span class="pl-pds">"</span></span>&gt;This is old version and does not operate. An application has moved to new address. \nPlease install newer version&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_restricter_info_update<span class="pl-pds">"</span></span>&gt;"This is old version and does not operate. Please update application"&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_restricter_info_open_new_version<span class="pl-pds">"</span></span>&gt;"This is old version and does not operate. Please open new version"&lt;/<span class="pl-ent">string</span>&gt;

    <span class="pl-c">&lt;!-- Additional information--&gt;</span>
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_internet_update_error<span class="pl-pds">"</span></span>&gt;Check your internet connection&lt;/<span class="pl-ent">string</span>&gt;
    &lt;<span class="pl-ent">string</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>mah_android_upd_info_popup_text<span class="pl-pds">"</span></span>&gt;MAHAndroidUpdater library&lt;/<span class="pl-ent">string</span>&gt;</pre></div>

<p><b><code>7)</code></b> As modul takes information from web servcie you need add <code>INTERNET</code> permission to main project.</p>

<div class="highlight highlight-text-xml"><pre>    &lt;<span class="pl-ent">uses-permission</span> <span class="pl-e">android</span><span class="pl-e">:</span><span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>android.permission.INTERNET<span class="pl-pds">"</span></span> /&gt;</pre></div>

<h1>
<a id="proguard-configuration" class="anchor" href="#proguard-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Proguard configuration</h1>

<p>MAHAndroidUpdater uses <a href="https://github.com/google/gson">Gson</a> and <a href="https://github.com/jhy/jsoup">Jsoup</a> libs. There for if you want to create your project with proguard you need to add following configuration to your proguard file.</p>

<div class="highlight highlight-source-groovy-gradle"><pre>##<span class="pl-k">--------------</span><span class="pl-k">-</span><span class="pl-k">Begin</span>: proguard configuration <span class="pl-k">for</span> <span class="pl-k">Gson</span>  <span class="pl-k">----------</span>
# Gson uses generic type information stored in a <span class="pl-k">class</span> <span class="pl-en">file</span> when working with fields. Proguard
# removes such information by default, so configure it to keep all of it.
-keepattributes Signature

# For using GSON @Expose annotation
-keepattributes *Annotation*

# Gson specific classes
-keep <span class="pl-k">class</span> <span class="pl-en">sun</span>.misc.Unsafe { <span class="pl-k">*</span>; }
#<span class="pl-k">-</span>keep <span class="pl-k">class</span> <span class="pl-en">com</span>.google.gson.stream.** { <span class="pl-k">*</span>; }

# <span class="pl-k">Application</span> classes that will be serialized<span class="pl-k">/</span>deserialized over <span class="pl-k">Gson</span>
<span class="pl-k">-</span>keep <span class="pl-k">class</span> <span class="pl-en">com</span>.google.gson.examples.android.model.** { <span class="pl-k">*</span>; }

##<span class="pl-k">--------------</span><span class="pl-k">-</span><span class="pl-k">End</span>: proguard configuration <span class="pl-k">for</span> <span class="pl-k">Gson</span>  <span class="pl-k">----------</span>

##<span class="pl-k">--------------</span><span class="pl-k">-</span><span class="pl-k">Begin</span>: proguard configuration <span class="pl-k">for</span> <span class="pl-k">Jsoup</span><span class="pl-k">--------------------------------</span>
<span class="pl-k">-</span>keep <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">org</span>.jsoup.** {
<span class="pl-k">public</span> <span class="pl-k">*</span>;
}
##<span class="pl-k">--------------</span><span class="pl-k">-</span><span class="pl-k">End</span>: proguard configuration <span class="pl-k">for</span> <span class="pl-k">Jsoup</span><span class="pl-k">--------------------------------</span></pre></div>

<h1>
<a id="end" class="anchor" href="#end" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>End</h1>

<p>Thats all. If you have any probelm with setting and using library please let me know. Write to <a href="mailto:settarxan@gmail.com">settarxan@gmail.com</a>. I will help.</p>

<h1>
<a id="contribution" class="anchor" href="#contribution" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contribution</h1>

<p>I am open to here offers and opinions from you </p>

<ul>
<li>Fork it</li>
<li>Create your feature branch (git checkout -b my-new-feature)</li>
<li>Commit your changes (git commit -am 'Added some feature')</li>
<li>Push to the branch (git push origin my-new-feature)</li>
<li>Create new Pull Request</li>
<li>Star it</li>
</ul>

<h1>
<a id="contribution-for-localization" class="anchor" href="#contribution-for-localization" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contribution for localization</h1>

<p>We need help to add new language localization support for libarary. If you have any hope to help us we were very happy and you can check following <i><a href="https://github.com/hummatli/MAHAndroidUpdater/issues">GitHub Issues URL</a></i> to contribute. To contribute get <a href="https://github.com/hummatli/MAHAndroidUpdater/blob/master/MAHAndroidUpdater/mah-android-updater/src/main/res/values/strings.xml">res/values/string.xml</a> file and translate to newer language. Place it on res/values-"spacific_lang"/string.xml</p>

<p>If you have any question please ask to me on <i><a href="mailto:settarxan@gmail.com"></a><a href="mailto:settarxan@gmail.com">settarxan@gmail.com</a></i></p>

<h1>
<a id="developed-by" class="anchor" href="#developed-by" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Developed By</h1>

<p>Sattar Hummatli - <a href="mailto:settarxan@gmail.com">settarxan@gmail.com</a></p>

<h1>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h1>

<p>Copyright 2016  - <a href="https://www.linkedin.com/in/hummatli">Sattar Hummatli</a>   </p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/hummatli/MAHAndroidUpdater">MAHAndroidUpdater</a> is maintained by <a href="https://github.com/hummatli">hummatli</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
